C:\Code\RASA V2\.venv\Lib\site-packages\langfuse\api\core\pydantic_utilities.py:10: UserWarning: Core Pydantic V1 functionality isn't compatible with Python 3.14 or greater.
  import pydantic.v1 as pydantic_v1  # type: ignore  # nopycln: import
\u26a0\ufe0f Langfuse import failed: unable to infer type for attribute "description". Telemetry disabled.
INFO:core.error_handlers:‚úÖ Centralized error handlers registered
INFO:shared_utils:AI server: database tables ensured
INFO:werkzeug:[31m[1mWARNING: This is a development server. Do not use it in a production deployment. Use a production WSGI server instead.[0m
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5003
 * Running on http://192.168.0.189:5003
INFO:werkzeug:[33mPress CTRL+C to quit[0m
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:27:56] "[33mGET / HTTP/1.1[0m" 404 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
WARNING:shared_utils:‚ö†Ô∏è Redis connection failed: Timeout connecting to server. Using in-memory cache only.
INFO:architecture.hybrid_router:‚úÖ HybridRouter initialized (Rasa: enabled)
INFO:shared_utils:‚úÖ Hybrid Router initialized (Rasa + LLM)
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 1d6c69f0 for user user-83
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
C:\Code\RASA V2\AI\plugins\adaptive_card_tool.py:249: FutureWarning: 

All support for the `google.generativeai` package has ended. It will no longer be receiving 
updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
See README for more details:

https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md

  import google.generativeai as genai
INFO:plugins.chat_tool:‚úÖ ChatTool: ImageSearchService enabled
INFO:plugins.chat_tool:‚úÖ ChatTool: Web search fallback enabled (Tavily)
INFO:plugins.web_search_tool:‚úÖ WebSearchTool: Tavily API configured
INFO:architecture.registry:‚úÖ ToolRegistry initialized with 9 tools: ['adaptive_card', 'chat', 'contact_form', 'file', 'news', 'survey', 'vector_search', 'weather', 'web_search']
INFO:architecture.router:üõ°Ô∏è Global Input Guard initialized
INFO:architecture.router:‚úÖ LLMRouter initialized (mode: code-first, providers: ['Bedrock', 'GROQ', 'Gemini'])
INFO:architecture.mcp_host:üìã Loaded 5 MCP server configs
INFO:architecture.mcp_client:‚úÖ Connected to MCP server 'leave' via stdio (PID: 50272)
INFO:architecture.mcp_client:[MCP-leave] C:\Code\RASA V2\.venv\Lib\site-packages\langfuse\api\core\pydantic_utilities.py:10: UserWarning: Core Pydantic V1 functionality isn't compatible with Python 3.14 or greater.
INFO:architecture.mcp_client:[MCP-leave] import pydantic.v1 as pydantic_v1  # type: ignore  # nopycln: import
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:29:27,911 | architecture.telemetry | WARNING | \u26a0\ufe0f Langfuse import failed: unable to infer type for attribute "description". Telemetry disabled.
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:29:27,912 | architecture.telemetry | INFO | \u2139\ufe0f Langfuse not available - telemetry disabled
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:29:27,964 | architecture.form_registry | INFO | \U0001f4cb Registered form handler: /submit_leave_form -> leave
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:29:27,964 | architecture.form_registry | INFO | \U0001f4cb Registered form handler: /submit_contact_info -> contact
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:29:27,965 | architecture.form_registry | INFO | \U0001f504 Registered follow-up patterns for: leave
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:29:27,965 | architecture.form_registry | INFO | \u2705 Default form handlers registered
INFO:architecture.mcp_client:‚úÖ MCP session initialized with 'leave'
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:29:28,011 | mcp.server.lowlevel.server | INFO | Processing request of type ListToolsRequest
INFO:architecture.mcp_client:üì¶ Discovered 6 tools from 'leave': ['analyze_leave_request', 'get_leave_request_card', 'validate_leave', 'get_leave_balance', 'get_leave_types', 'calculate_leave_days']
INFO:architecture.mcp_client:‚úÖ Connected to MCP server 'brochure' via stdio (PID: 51256)
INFO:architecture.mcp_client:[MCP-brochure] C:\Code\RASA V2\.venv\Lib\site-packages\langfuse\api\core\pydantic_utilities.py:10: UserWarning: Core Pydantic V1 functionality isn't compatible with Python 3.14 or greater.
INFO:architecture.mcp_client:[MCP-brochure] import pydantic.v1 as pydantic_v1  # type: ignore  # nopycln: import
INFO:architecture.mcp_client:[MCP-brochure] \u26a0\ufe0f Langfuse import failed: unable to infer type for attribute "description". Telemetry disabled.
INFO:architecture.mcp_client:‚úÖ MCP session initialized with 'brochure'
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:29:28,673 | mcp.server.lowlevel.server | INFO | Processing request of type ListToolsRequest
INFO:architecture.mcp_client:üì¶ Discovered 2 tools from 'brochure': ['generate_brochure', 'get_brochure_template']
INFO:architecture.mcp_client:‚úÖ Connected to MCP server 'knowledgebase' via stdio (PID: 55016)
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA V2\.venv\Lib\site-packages\langfuse\api\core\pydantic_utilities.py:10: UserWarning: Core Pydantic V1 functionality isn't compatible with Python 3.14 or greater.
INFO:architecture.mcp_client:[MCP-knowledgebase] import pydantic.v1 as pydantic_v1  # type: ignore  # nopycln: import
INFO:architecture.mcp_client:[MCP-knowledgebase] \u26a0\ufe0f Langfuse import failed: unable to infer type for attribute "description". Telemetry disabled.
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:29:35] INFO     Use pytorch             SentenceTransformer.py:219
INFO:architecture.mcp_client:[MCP-knowledgebase] device_name: cpu
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     Load pretrained         SentenceTransformer.py:227
INFO:architecture.mcp_client:[MCP-knowledgebase] SentenceTransformer:
INFO:architecture.mcp_client:[MCP-knowledgebase] sentence-transformers/a
INFO:architecture.mcp_client:[MCP-knowledgebase] ll-MiniLM-L6-v2
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Loaded embedding model: sentence-transformers/all-MiniLM-L6-v2
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Loading existing embeddings from ..\Vector\data\vectordb\embeddings.pkl
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Loaded 277 document chunks
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Vector database initialized successfully
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:29:40] INFO     Found credentials in           credentials.py:1252
INFO:architecture.mcp_client:[MCP-knowledgebase] environment variables.
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     Found token in environment           tokens.py:362
INFO:architecture.mcp_client:[MCP-knowledgebase] variables.
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 Bedrock runtime client         llm_utils.py:113
INFO:architecture.mcp_client:[MCP-knowledgebase] initialized
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:29:41] INFO     \u2705 GROQ client initialized        llm_utils.py:126
INFO:architecture.mcp_client:[MCP-knowledgebase] (model: llama-3.3-70b-versatile)
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA V2\AI\architecture\llm_utils.py:178: FutureWarning:
INFO:architecture.mcp_client:[MCP-knowledgebase] All support for the `google.generativeai` package has ended. It will no longer be receiving
INFO:architecture.mcp_client:[MCP-knowledgebase] updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
INFO:architecture.mcp_client:[MCP-knowledgebase] See README for more details:
INFO:architecture.mcp_client:[MCP-knowledgebase] https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md
INFO:architecture.mcp_client:[MCP-knowledgebase] import google.generativeai as genai
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 Google Gemini client           llm_utils.py:181
INFO:architecture.mcp_client:[MCP-knowledgebase] initialized (model:
INFO:architecture.mcp_client:[MCP-knowledgebase] gemini-2.5-pro)
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 MultiProviderLLM initialized
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB]    LLM Status: {'bedrock': {'available': True, 'model': 'meta.llama3-8b-instruct-v1:0', 'failures': 0}, 'groq': {'available': True, 'model': 'llama-3.3-70b-versatile', 'failures': 0}, 'google': {'available': True, 'model': 'gemini-2.5-pro', 'failures': 0}}
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     ChartRenderer initialized visualization_tool.py:91
INFO:architecture.mcp_client:[MCP-knowledgebase] (charts_dir: C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb)
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     SmartVisualizationTool   visualization_tool.py:639
INFO:architecture.mcp_client:[MCP-knowledgebase] initialized (charts_dir:
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb)
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 SmartVisualizationTool initialized (auto-detect charts)
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Starting Knowledge Base MCP Server (stdio)...
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Architecture: Schema-Driven Visualization + Multi-Provider LLM
INFO:architecture.mcp_client:‚úÖ MCP session initialized with 'knowledgebase'
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] ListToolsRequest
INFO:architecture.mcp_client:üì¶ Discovered 2 tools from 'knowledgebase': ['knowledgebase_query', 'knowledgebase_health']
INFO:architecture.mcp_client:‚úÖ Connected to MCP server 'sql' via stdio (PID: 48312)
INFO:architecture.mcp_client:[MCP-sql] C:\Code\RASA V2\.venv\Lib\site-packages\langchain_core\_api\deprecation.py:26: UserWarning: Core Pydantic V1 functionality isn't compatible with Python 3.14 or greater.
INFO:architecture.mcp_client:[MCP-sql] from pydantic.v1.fields import FieldInfo as FieldInfoV1
INFO:architecture.mcp_client:[MCP-sql] \u26a0\ufe0f Langfuse import failed: unable to infer type for attribute "description". Telemetry disabled.
INFO:architecture.mcp_client:[MCP-sql] [01/03/26 19:29:42] INFO     Found credentials in           credentials.py:1252
INFO:architecture.mcp_client:[MCP-sql] environment variables.
INFO:architecture.mcp_client:[MCP-sql] INFO     Found token in environment           tokens.py:362
INFO:architecture.mcp_client:[MCP-sql] variables.
INFO:architecture.mcp_client:[MCP-sql] INFO     \u2705 Bedrock runtime client         llm_utils.py:113
INFO:architecture.mcp_client:[MCP-sql] initialized
INFO:architecture.mcp_client:[MCP-sql] INFO     \u2705 GROQ client initialized        llm_utils.py:126
INFO:architecture.mcp_client:[MCP-sql] (model: llama-3.3-70b-versatile)
INFO:architecture.mcp_client:[MCP-sql] C:\Code\RASA V2\AI\architecture\llm_utils.py:178: FutureWarning:
INFO:architecture.mcp_client:[MCP-sql] All support for the `google.generativeai` package has ended. It will no longer be receiving
INFO:architecture.mcp_client:[MCP-sql] updates or bug fixes. Please switch to the `google.genai` package as soon as possible.
INFO:architecture.mcp_client:[MCP-sql] See README for more details:
INFO:architecture.mcp_client:[MCP-sql] https://github.com/google-gemini/deprecated-generative-ai-python/blob/main/README.md
INFO:architecture.mcp_client:[MCP-sql] import google.generativeai as genai
INFO:architecture.mcp_client:[MCP-sql] [01/03/26 19:29:43] INFO     \u2705 Google Gemini client           llm_utils.py:181
INFO:architecture.mcp_client:[MCP-sql] initialized (model:
INFO:architecture.mcp_client:[MCP-sql] gemini-2.5-pro)
INFO:architecture.mcp_client:[MCP-sql] [SQL] \u2705 MultiProviderLLM initialized
INFO:architecture.mcp_client:[MCP-sql] [SQL]    LLM Status: {'bedrock': {'available': True, 'model': 'meta.llama3-8b-instruct-v1:0', 'failures': 0}, 'groq': {'available': True, 'model': 'llama-3.3-70b-versatile', 'failures': 0}, 'google': {'available': True, 'model': 'gemini-2.5-pro', 'failures': 0}}
INFO:architecture.mcp_client:[MCP-sql] [SQL] Starting SQL MCP Server (stdio)...
INFO:architecture.mcp_client:[MCP-sql] [SQL] Architecture: Schema-Driven Visualization + Multi-Provider LLM
INFO:architecture.mcp_client:‚úÖ MCP session initialized with 'sql'
INFO:architecture.mcp_client:[MCP-sql] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-sql] ListToolsRequest
INFO:architecture.mcp_client:üì¶ Discovered 3 tools from 'sql': ['sql_query', 'sql_schema', 'sql_health']
INFO:architecture.mcp_client:‚úÖ Connected to MCP server 'secure_rag' via stdio (PID: 32868)
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:29:43,695 - secure_rag_server - INFO - \u2705 Secure RAG module loaded
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:29:43,696 - secure_rag_server - INFO - \U0001f680 Starting Secure RAG MCP Server...
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:29:43,699 - secure_rag_server - INFO - \U0001f4e1 Server ready
INFO:architecture.mcp_client:‚úÖ MCP session initialized with 'secure_rag'
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:29:43,704 - mcp.server.lowlevel.server - INFO - Processing request of type ListToolsRequest
INFO:architecture.mcp_client:üì¶ Discovered 4 tools from 'secure_rag': ['secure_query', 'check_permissions', 'list_users', 'get_stats']
INFO:architecture.mcp_host:‚úÖ Connected to 5/5 MCP servers
INFO:architecture.router:üîå MCP Host connected: 5 servers, 17 tools
INFO:architecture.router:üêç Code executor initialized (unified local + MCP)
INFO:architecture.hybrid_router:üîå MCP initialized: 5 servers, 17 tools
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:29:43] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'Who gave the budget speech?' [state_id=user-83]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: Who gave the budget speech?... [state_id=user-83]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 33.67it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:29:44] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:29:45] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Visualization: No chartable data found in result
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-83]: chart=None
[38;5;45müéØ ROUTING[0m
  Message: "Who gave the budget speech?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 15e67428 for user user-83
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:botocore.credentials:Found credentials in environment variables.
INFO:botocore.tokens:Found token in environment variables.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:30:22] "POST /chat HTTP/1.1" 200 -
INFO:shared_utils:üìé File uploaded: budget_speech.pdf ‚Üí ..\API\state\uploads\20260103_193034_budget_speech.pdf
INFO:shared_utils:üìÑ Processing document: ..\API\state\uploads\20260103_193034_budget_speech.pdf
WARNING:shared_utils:‚ö†Ô∏è PyMuPDF not installed, falling back to PyPDF2
INFO:shared_utils:üìÑ PDF has 60 pages (using PyPDF2)
INFO:shared_utils:üìÑ PyPDF2 extracted: 93150 chars from 60 pages
INFO:shared_utils:üìÑ Extracted text length: 93137 chars
INFO:shared_utils:üìÑ Arabic characters in extracted text: 0
INFO:shared_utils:üìÑ Detected language: en, using: en
INFO:shared_utils:‚úÖ Document analysis complete: 371 chars
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:30:36] "POST /upload HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 0066d2a8 for user user-85
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:31:21] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'Who gave the budget speech?' [state_id=user-85]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: Who gave the budget speech?... [state_id=user-85]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 157.69it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:31:22] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Visualization: No chartable data found in result
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-85]: chart=None
[38;5;45müéØ ROUTING[0m
  Message: "Who gave the budget speech?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session e636e30d for user user-85
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:31:59] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 34 chars -> 34 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session c34a4e81 for user user-85
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:32:30] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'What is the revised tax structure?' [state_id=user-85]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: What is the revised tax structure?... [state_id=user-85]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 161.89it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:32:31] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     ChartRenderer initialized visualization_tool.py:91
INFO:architecture.mcp_client:[MCP-knowledgebase] (charts_dir: C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb)
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 Pie chart saved:      visualization_tool.py:268
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-85_20260103_193231.png
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     SmartVisualizationTool:  visualization_tool.py:714
INFO:architecture.mcp_client:[MCP-knowledgebase] Created pie chart at
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-85_20260103_193231.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 SmartVisualizationTool created chart: charts/kb/pie_user-85_20260103_193231.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-85]: chart=charts/kb/pie_user-85_20260103_193231.png
[38;5;45müéØ ROUTING[0m
  Message: "What is the revised tax structure?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session acf0d2f2 for user user-85
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:33:08] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 44 chars -> 44 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 6c4bfde0 for user user-85
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:plugins.weather_tool:Weather request: city=Bangalore, when=None, parsed_offset=0, when_text=current
INFO:architecture.router:Formatting response for tool: weather
[38;5;45müéØ ROUTING[0m
  Message: "What is the weather in Bangalore like today?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: weather[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 0e69bf67 for user user-85
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:34:18] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 19 chars -> 19 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 29578df3 for user user-85
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:34:50,458 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:34:50,806 - secure_rag_server - INFO - \U0001f680 SecureRAGPipeline initialized
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:34:50,995 - botocore.credentials - INFO - Found credentials in environment variables.
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:34:51,060 - botocore.tokens - INFO - Found token in environment variables.
[38;5;45müéØ ROUTING[0m
  Message: "Can I take a leave?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session e48b21ff for user user-85
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:35:28] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 0905f3ea for user user-85
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:36:00,560 | mcp.server.lowlevel.server | INFO | Processing request of type CallToolRequest
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:36:00,560 | brochure-server | INFO | \U0001f50c MCP TOOL: generate_brochure
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:36:00,560 | brochure-server | INFO |    Topic: Coffee
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:36:00,759 | botocore.credentials | INFO | Found credentials in environment variables.
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:36:00,837 | botocore.tokens | INFO | Found token in environment variables.
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:36:01,680 | brochure-server | INFO |    Subject: Coffee
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:36:01,680 | brochure-server | INFO |    Calling LLM for content...
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:36:03,892 | brochure-server | INFO |    \u2705 Content generated: Brewing Perfection.
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:36:05,019 | httpx | INFO | HTTP Request: GET https://www.googleapis.com/customsearch/v1?q=Coffee+beans+in+a+coffee+roaster&searchType=image&num=5&safe=active&imgType=photo&key=AIzaSyAejUSP2AkyUqIIldlXREFVptSZGzKZuf8&cx=20f183726d9fc4dc4 "HTTP/1.1 200 OK"
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:36:05,020 | brochure-server | INFO |    \U0001f5bc\ufe0f Found valid image for 'Coffee beans in a coffee roaster': https://www.nescafe.com/in/sites/default/files/2023-11/Coffee%20Roasting%20Heade...
[38;5;45müéØ ROUTING[0m
  Message: "Create a brochure on Coffee"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: brochure.generate_brochure[0m
  Reason: MCP server: brochure
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 6b29c2c9 for user user-85
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:36:41] "POST /chat HTTP/1.1" 200 -
INFO:shared_utils:üìé File uploaded: budget_speech.pdf ‚Üí ..\API\state\uploads\20260103_193642_budget_speech.pdf
INFO:shared_utils:üìÑ Processing document: ..\API\state\uploads\20260103_193642_budget_speech.pdf
WARNING:shared_utils:‚ö†Ô∏è PyMuPDF not installed, falling back to PyPDF2
INFO:shared_utils:üìÑ PDF has 60 pages (using PyPDF2)
INFO:shared_utils:üìÑ PyPDF2 extracted: 93150 chars from 60 pages
INFO:shared_utils:üìÑ Extracted text length: 93137 chars
INFO:shared_utils:üìÑ Arabic characters in extracted text: 0
INFO:shared_utils:üìÑ Detected language: en, using: en
INFO:shared_utils:‚úÖ Document analysis complete: 365 chars
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:36:44] "POST /upload HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 19 chars -> 19 chars
WARNING:architecture.pre_router_guard:üõ°Ô∏è Guard blocked: category=weapons, pattern matched
WARNING:shared_utils:Blocked dangerous input (pre-router guard): category=weapons
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:36:45] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 14 chars -> 14 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 5986889f for user user-85
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
WARNING:plugins.chat_tool:Failed to generate related questions: cannot access local variable 'json' where it is not associated with a value
INFO:architecture.router:üì∑ Chat tool returned image_data for: Beagle | Overview, Lifespan, Health, History & Temperament ...
INFO:architecture.router:Formatting response for tool: chat
[38;5;45müéØ ROUTING[0m
  Message: "What is a dog?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: chat[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 9f2c4dab for user user-85
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:37:56] "POST /chat HTTP/1.1" 200 -
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:38:04] "POST /clear_chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 26 chars -> 26 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session a284a484 for user user-85
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:38:37,961 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "My favorite color is blue."
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 88b0586a for user user-85
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:39:15] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 25 chars -> 25 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 9aca3ab1 for user user-85
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.router:Formatting response for tool: chat
[38;5;45müéØ ROUTING[0m
  Message: "What's my favorite color?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: chat[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 8018c5f1 for user user-85
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:40:24] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 379320b1 for user user-86
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:43:09] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'Who gave the budget speech?' [state_id=user-86]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: Who gave the budget speech?... [state_id=user-86]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 173.28it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:43:10] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Visualization: No chartable data found in result
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-86]: chart=None
[38;5;45müéØ ROUTING[0m
  Message: "Who gave the budget speech?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 936280ab for user user-86
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:43:47] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 34 chars -> 34 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 93b710f7 for user user-86
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:44:18] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'What is the revised tax structure?' [state_id=user-86]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: What is the revised tax structure?... [state_id=user-86]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 165.93it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:44:19] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:44:20] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     ChartRenderer initialized visualization_tool.py:91
INFO:architecture.mcp_client:[MCP-knowledgebase] (charts_dir: C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb)
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 Pie chart saved:      visualization_tool.py:268
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-86_20260103_194420.png
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     SmartVisualizationTool:  visualization_tool.py:714
INFO:architecture.mcp_client:[MCP-knowledgebase] Created pie chart at
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-86_20260103_194420.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 SmartVisualizationTool created chart: charts/kb/pie_user-86_20260103_194420.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-86]: chart=charts/kb/pie_user-86_20260103_194420.png
[38;5;45müéØ ROUTING[0m
  Message: "What is the revised tax structure?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session a5980735 for user user-86
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:44:57] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 44 chars -> 44 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 34b4c61d for user user-86
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:plugins.weather_tool:Weather request: city=Bangalore, when=None, parsed_offset=0, when_text=current
INFO:architecture.router:Formatting response for tool: weather
[38;5;45müéØ ROUTING[0m
  Message: "What is the weather in Bangalore like today?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: weather[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session cb2c11a9 for user user-86
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:46:10] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 19 chars -> 19 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 915fb39e for user user-86
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:46:42,338 | mcp.server.lowlevel.server | INFO | Processing request of type CallToolRequest
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:46:42,338 | leave-server | INFO | \U0001f50c MCP TOOL: analyze_leave_request
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:46:42,338 | leave-server | INFO |    Query: Can I take a leave?
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:46:42,338 | leave-server | INFO |    Employee ID: 1
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:46:42,339 | leave-server | ERROR | LLM extraction error: name 'asyncio' is not defined
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:46:42,339 | leave-server | INFO |    Extracted entities: {'start_date': None, 'end_date': None, 'leave_type': None, 'duration_days': None, 'confidence': 0.5}
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:46:42,339 | leave-server | INFO |    \u26a0\ufe0f Missing parameters - showing form
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:46:42,339 | leave-server | INFO |    Missing: start date, end date, leave type
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 19:46:42,339 | leave-server | INFO |    Result type: adaptive_card (pre-filled form)
[38;5;45müéØ ROUTING[0m
  Message: "Can I take a leave?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: leave.analyze_leave_request[0m
  Reason: MCP server: leave
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 3fbf7c99 for user user-86
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:47:19] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session ea04b449 for user user-86
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:47:50,938 | mcp.server.lowlevel.server | INFO | Processing request of type CallToolRequest
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:47:50,939 | brochure-server | INFO | \U0001f50c MCP TOOL: generate_brochure
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:47:50,939 | brochure-server | INFO |    Topic: Coffee
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:47:51,212 | brochure-server | INFO |    Subject: Coffee
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:47:51,212 | brochure-server | INFO |    Calling LLM for content...
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:47:53,316 | brochure-server | INFO |    \u2705 Content generated: The Daily Grind.
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:47:54,373 | httpx | INFO | HTTP Request: GET https://www.googleapis.com/customsearch/v1?q=Coffee+beans+on+a+wooden+table&searchType=image&num=5&safe=active&imgType=photo&key=AIzaSyAejUSP2AkyUqIIldlXREFVptSZGzKZuf8&cx=20f183726d9fc4dc4 "HTTP/1.1 200 OK"
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 19:47:54,374 | brochure-server | INFO |    \U0001f5bc\ufe0f Found valid image for 'Coffee beans on a wooden table': https://i.pinimg.com/736x/26/83/50/2683506344a705a6a8337fcab0e21683.jpg...
[38;5;45müéØ ROUTING[0m
  Message: "Create a brochure on Coffee"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: brochure.generate_brochure[0m
  Reason: MCP server: brochure
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 840ab8a1 for user user-86
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:48:31] "POST /chat HTTP/1.1" 200 -
INFO:shared_utils:üìé File uploaded: budget_speech.pdf ‚Üí ..\API\state\uploads\20260103_194834_budget_speech.pdf
INFO:shared_utils:üìÑ Processing document: ..\API\state\uploads\20260103_194834_budget_speech.pdf
WARNING:shared_utils:‚ö†Ô∏è PyMuPDF not installed, falling back to PyPDF2
INFO:shared_utils:üìÑ PDF has 60 pages (using PyPDF2)
INFO:shared_utils:üìÑ PyPDF2 extracted: 93150 chars from 60 pages
INFO:shared_utils:üìÑ Extracted text length: 93137 chars
INFO:shared_utils:üìÑ Arabic characters in extracted text: 0
INFO:shared_utils:üìÑ Detected language: en, using: en
INFO:shared_utils:‚úÖ Document analysis complete: 342 chars
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:48:36] "POST /upload HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 19 chars -> 19 chars
WARNING:architecture.pre_router_guard:üõ°Ô∏è Guard blocked: category=weapons, pattern matched
WARNING:shared_utils:Blocked dangerous input (pre-router guard): category=weapons
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:48:43] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 14 chars -> 14 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 27f5a309 for user user-86
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:49:15,877 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "What is a dog?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 506a293f for user user-86
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:49:53] "POST /chat HTTP/1.1" 200 -
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:50:02] "POST /clear_chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 26 chars -> 26 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 410794e9 for user user-86
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:50:35,562 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "My favorite color is blue."
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session dc367f33 for user user-86
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:51:12] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 25 chars -> 25 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 3b3d25ee for user user-86
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.router:Formatting response for tool: chat
[38;5;45müéØ ROUTING[0m
  Message: "What's my favorite color?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: chat[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session f124b306 for user user-86
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:52:22] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session a15c6c8a for user user-87
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:55:56] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'Who gave the budget speech?' [state_id=user-87]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: Who gave the budget speech?... [state_id=user-87]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 100.28it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Visualization: No chartable data found in result
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-87]: chart=None
[38;5;45müéØ ROUTING[0m
  Message: "Who gave the budget speech?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 30fa9b6d for user user-87
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:56:34] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 34 chars -> 34 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 4e3045fd for user user-87
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:57:05] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'What is the revised tax structure?' [state_id=user-87]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: What is the revised tax structure?... [state_id=user-87]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 135.31it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 19:57:06] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     ChartRenderer initialized visualization_tool.py:91
INFO:architecture.mcp_client:[MCP-knowledgebase] (charts_dir: C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb)
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 Pie chart saved:      visualization_tool.py:268
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-87_20260103_195706.png
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     SmartVisualizationTool:  visualization_tool.py:714
INFO:architecture.mcp_client:[MCP-knowledgebase] Created pie chart at
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-87_20260103_195706.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 SmartVisualizationTool created chart: charts/kb/pie_user-87_20260103_195706.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-87]: chart=charts/kb/pie_user-87_20260103_195706.png
[38;5;45müéØ ROUTING[0m
  Message: "What is the revised tax structure?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 395e352d for user user-87
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:57:43] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 44 chars -> 44 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session c80bc6a7 for user user-87
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:plugins.weather_tool:Weather request: city=Bangalore, when=None, parsed_offset=0, when_text=current
INFO:architecture.router:Formatting response for tool: weather
[38;5;45müéØ ROUTING[0m
  Message: "What is the weather in Bangalore like today?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: weather[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 0a9cb081 for user user-87
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 19:58:59] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 19 chars -> 19 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 708b20aa for user user-87
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 19:59:31,763 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "Can I take a leave?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 60c62c08 for user user-87
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:00:09] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 6a6fa685 for user user-87
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:00:41,134 | mcp.server.lowlevel.server | INFO | Processing request of type CallToolRequest
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:00:41,134 | brochure-server | INFO | \U0001f50c MCP TOOL: generate_brochure
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:00:41,134 | brochure-server | INFO |    Topic: Coffee
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:00:41,416 | brochure-server | INFO |    Subject: Coffee
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:00:41,416 | brochure-server | INFO |    Calling LLM for content...
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:00:43,590 | brochure-server | INFO |    \u2705 Content generated: The Perfect Brew.
[38;5;45müéØ ROUTING[0m
  Message: "Create a brochure on Coffee"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: brochure.generate_brochure[0m
  Reason: MCP server: brochure
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 0531e2e5 for user user-87
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:01:20] "POST /chat HTTP/1.1" 200 -
INFO:shared_utils:üìé File uploaded: budget_speech.pdf ‚Üí ..\API\state\uploads\20260103_200122_budget_speech.pdf
INFO:shared_utils:üìÑ Processing document: ..\API\state\uploads\20260103_200122_budget_speech.pdf
WARNING:shared_utils:‚ö†Ô∏è PyMuPDF not installed, falling back to PyPDF2
INFO:shared_utils:üìÑ PDF has 60 pages (using PyPDF2)
INFO:shared_utils:üìÑ PyPDF2 extracted: 93150 chars from 60 pages
INFO:shared_utils:üìÑ Extracted text length: 93137 chars
INFO:shared_utils:üìÑ Arabic characters in extracted text: 0
INFO:shared_utils:üìÑ Detected language: en, using: en
INFO:shared_utils:‚úÖ Document analysis complete: 382 chars
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:01:24] "POST /upload HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 19 chars -> 19 chars
WARNING:architecture.pre_router_guard:üõ°Ô∏è Guard blocked: category=weapons, pattern matched
WARNING:shared_utils:Blocked dangerous input (pre-router guard): category=weapons
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:01:30] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 14 chars -> 14 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 0164bc8b for user user-87
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 20:02:02,884 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "What is a dog?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session e1878bf9 for user user-87
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:02:40] "POST /chat HTTP/1.1" 200 -
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:02:50] "POST /clear_chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 26 chars -> 26 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session f2f699d0 for user user-87
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 20:03:23,588 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "My favorite color is blue."
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 1028f7cd for user user-87
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:04:01] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 25 chars -> 25 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 94980f8f for user user-87
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.router:Formatting response for tool: chat
[38;5;45müéØ ROUTING[0m
  Message: "What's my favorite color?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: chat[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session bdaa08f0 for user user-87
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:05:10] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session b36ddfa3 for user user-88
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:08:34] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'Who gave the budget speech?' [state_id=user-88]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: Who gave the budget speech?... [state_id=user-88]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 125.30it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:08:35] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Visualization: No chartable data found in result
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-88]: chart=None
[38;5;45müéØ ROUTING[0m
  Message: "Who gave the budget speech?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session ca8b6e14 for user user-88
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:09:12] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 34 chars -> 34 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 5fb5e4c7 for user user-88
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:09:43] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'What is the revised tax structure?' [state_id=user-88]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: What is the revised tax structure?... [state_id=user-88]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 139.53it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:09:44] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:09:45] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     ChartRenderer initialized visualization_tool.py:91
INFO:architecture.mcp_client:[MCP-knowledgebase] (charts_dir: C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb)
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 Pie chart saved:      visualization_tool.py:268
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-88_20260103_200945.png
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     SmartVisualizationTool:  visualization_tool.py:714
INFO:architecture.mcp_client:[MCP-knowledgebase] Created pie chart at
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-88_20260103_200945.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 SmartVisualizationTool created chart: charts/kb/pie_user-88_20260103_200945.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-88]: chart=charts/kb/pie_user-88_20260103_200945.png
[38;5;45müéØ ROUTING[0m
  Message: "What is the revised tax structure?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 40a83cb5 for user user-88
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:10:22] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 44 chars -> 44 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session ad15e3f0 for user user-88
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:plugins.weather_tool:Weather request: city=Bangalore, when=None, parsed_offset=0, when_text=current
INFO:architecture.router:Formatting response for tool: weather
[38;5;45müéØ ROUTING[0m
  Message: "What is the weather in Bangalore like today?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: weather[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 585310b6 for user user-88
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:11:40] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 19 chars -> 19 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 3f87570d for user user-88
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 20:12:12,420 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "Can I take a leave?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session a1100438 for user user-88
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:12:49] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session cc3c45de for user user-88
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:13:21,752 | mcp.server.lowlevel.server | INFO | Processing request of type CallToolRequest
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:13:21,752 | brochure-server | INFO | \U0001f50c MCP TOOL: generate_brochure
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:13:21,752 | brochure-server | INFO |    Topic: Coffee
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:13:22,037 | brochure-server | INFO |    Subject: Coffee
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:13:22,037 | brochure-server | INFO |    Calling LLM for content...
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:13:24,265 | brochure-server | INFO |    \u2705 Content generated: The Daily Grind.
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:13:25,350 | httpx | INFO | HTTP Request: GET https://www.googleapis.com/customsearch/v1?q=Coffee+beans+on+a+wooden+table&searchType=image&num=5&safe=active&imgType=photo&key=AIzaSyAejUSP2AkyUqIIldlXREFVptSZGzKZuf8&cx=20f183726d9fc4dc4 "HTTP/1.1 200 OK"
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:13:25,351 | brochure-server | INFO |    \U0001f5bc\ufe0f Found valid image for 'Coffee beans on a wooden table': https://i.pinimg.com/736x/26/83/50/2683506344a705a6a8337fcab0e21683.jpg...
[38;5;45müéØ ROUTING[0m
  Message: "Create a brochure on Coffee"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: brochure.generate_brochure[0m
  Reason: MCP server: brochure
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 4bba5079 for user user-88
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:14:02] "POST /chat HTTP/1.1" 200 -
INFO:shared_utils:üìé File uploaded: budget_speech.pdf ‚Üí ..\API\state\uploads\20260103_201404_budget_speech.pdf
INFO:shared_utils:üìÑ Processing document: ..\API\state\uploads\20260103_201404_budget_speech.pdf
WARNING:shared_utils:‚ö†Ô∏è PyMuPDF not installed, falling back to PyPDF2
INFO:shared_utils:üìÑ PDF has 60 pages (using PyPDF2)
INFO:shared_utils:üìÑ PyPDF2 extracted: 93150 chars from 60 pages
INFO:shared_utils:üìÑ Extracted text length: 93137 chars
INFO:shared_utils:üìÑ Arabic characters in extracted text: 0
INFO:shared_utils:üìÑ Detected language: en, using: en
INFO:shared_utils:‚úÖ Document analysis complete: 358 chars
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:14:05] "POST /upload HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 19 chars -> 19 chars
WARNING:architecture.pre_router_guard:üõ°Ô∏è Guard blocked: category=weapons, pattern matched
WARNING:shared_utils:Blocked dangerous input (pre-router guard): category=weapons
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:14:12] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 14 chars -> 14 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 19b19f7a for user user-88
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 20:14:44,889 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "What is a dog?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session d157b3d0 for user user-88
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:15:22] "POST /chat HTTP/1.1" 200 -
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:15:34] "POST /clear_chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 26 chars -> 26 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 80c649c2 for user user-88
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 20:16:07,572 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "My favorite color is blue."
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 2b234b86 for user user-88
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:16:45] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 25 chars -> 25 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 8ffc3337 for user user-88
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.router:Formatting response for tool: chat
[38;5;45müéØ ROUTING[0m
  Message: "What's my favorite color?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: chat[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session f68cc5b8 for user user-88
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:17:54] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 6ee99ea1 for user user-89
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:20:01] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'Who gave the budget speech?' [state_id=user-89]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: Who gave the budget speech?... [state_id=user-89]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 139.16it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:20:02] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Visualization: No chartable data found in result
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-89]: chart=None
[38;5;45müéØ ROUTING[0m
  Message: "Who gave the budget speech?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session f47dac70 for user user-89
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:20:39] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 34 chars -> 34 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 5846528f for user user-89
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:21:10] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'What is the revised tax structure?' [state_id=user-89]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: What is the revised tax structure?... [state_id=user-89]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 111.23it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:21:11] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     ChartRenderer initialized visualization_tool.py:91
INFO:architecture.mcp_client:[MCP-knowledgebase] (charts_dir: C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb)
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 Pie chart saved:      visualization_tool.py:268
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-89_20260103_202111.png
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     SmartVisualizationTool:  visualization_tool.py:714
INFO:architecture.mcp_client:[MCP-knowledgebase] Created pie chart at
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-89_20260103_202111.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 SmartVisualizationTool created chart: charts/kb/pie_user-89_20260103_202111.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-89]: chart=charts/kb/pie_user-89_20260103_202111.png
[38;5;45müéØ ROUTING[0m
  Message: "What is the revised tax structure?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 1d982ef0 for user user-89
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:21:48] "POST /chat HTTP/1.1" 200 -
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:22:34] "POST /clear_chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 26 chars -> 26 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 0b509b84 for user user-90
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 20:23:07,592 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "My favorite color is blue."
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 2777942f for user user-90
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:23:45] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 25 chars -> 25 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 4735ea91 for user user-90
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.router:Formatting response for tool: chat
[38;5;45müéØ ROUTING[0m
  Message: "What's my favorite color?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: chat[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session a0ea3caa for user user-90
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:24:54] "POST /chat HTTP/1.1" 200 -
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:26:17] "POST /clear_chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 26 chars -> 26 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 9219f541 for user user-91
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 20:26:50,793 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "My favorite color is blue."
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 16d10eb8 for user user-91
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:27:28] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 25 chars -> 25 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 8a30e393 for user user-91
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.router:Formatting response for tool: chat
[38;5;45müéØ ROUTING[0m
  Message: "What's my favorite color?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: chat[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session c11ec661 for user user-91
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:28:37] "POST /chat HTTP/1.1" 200 -
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:31:30] "POST /clear_chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 26 chars -> 26 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 012334dc for user user-92
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 20:32:03,264 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "My favorite color is blue."
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 522201d4 for user user-92
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:32:40] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 25 chars -> 25 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 9456156c for user user-92
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.router:Formatting response for tool: chat
[38;5;45müéØ ROUTING[0m
  Message: "What's my favorite color?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: chat[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session c846201a for user user-92
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:33:50] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session db9c80b5 for user user-93
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:34:59] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'Who gave the budget speech?' [state_id=user-93]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: Who gave the budget speech?... [state_id=user-93]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 36.03it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:35:00] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:35:01] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Visualization: No chartable data found in result
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-93]: chart=None
[38;5;45müéØ ROUTING[0m
  Message: "Who gave the budget speech?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session c01b2800 for user user-93
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:35:38] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 34 chars -> 34 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 2e5fe5b4 for user user-93
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:36:09] INFO     Processing request of type           server.py:713
INFO:architecture.mcp_client:[MCP-knowledgebase] CallToolRequest
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB query received: 'What is the revised tax structure?' [state_id=user-93]
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] Processing KB query: What is the revised tax structure?... [state_id=user-93]
INFO:architecture.mcp_client:[MCP-knowledgebase] Batches:   0%|          | 0/1 [00:00<?, ?it/s]Batches: 100%|##########| 1/1 [00:00<00:00, 90.25it/s]
INFO:architecture.mcp_client:[MCP-knowledgebase] [01/03/26 20:36:10] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 KB answer generated via bedrock
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 LLM call succeeded via bedrock llm_utils.py:460
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     ChartRenderer initialized visualization_tool.py:91
INFO:architecture.mcp_client:[MCP-knowledgebase] (charts_dir: C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb)
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     \u2705 Pie chart saved:      visualization_tool.py:268
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-93_20260103_203610.png
INFO:architecture.mcp_client:[MCP-knowledgebase] INFO     SmartVisualizationTool:  visualization_tool.py:714
INFO:architecture.mcp_client:[MCP-knowledgebase] Created pie chart at
INFO:architecture.mcp_client:[MCP-knowledgebase] C:\Code\RASA
INFO:architecture.mcp_client:[MCP-knowledgebase] V2\Web\charts\kb\pie_use
INFO:architecture.mcp_client:[MCP-knowledgebase] r-93_20260103_203610.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] \u2705 SmartVisualizationTool created chart: charts/kb/pie_user-93_20260103_203610.png
INFO:architecture.mcp_client:[MCP-knowledgebase] [KB] KB response [state_id=user-93]: chart=charts/kb/pie_user-93_20260103_203610.png
[38;5;45müéØ ROUTING[0m
  Message: "What is the revised tax structure?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: knowledgebase.knowledgebase_query[0m
  Reason: MCP server: knowledgebase
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session a6df9b23 for user user-93
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:36:47] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 44 chars -> 44 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 382b7f72 for user user-93
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:plugins.weather_tool:Weather request: city=Bangalore, when=None, parsed_offset=0, when_text=current
INFO:architecture.router:Formatting response for tool: weather
[38;5;45müéØ ROUTING[0m
  Message: "What is the weather in Bangalore like today?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: weather[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session e0dc9d51 for user user-93
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:38:07] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 19 chars -> 19 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 6294dcc6 for user user-93
INFO:architecture.hybrid_router:üìÑ File context: detected different topic, letting other tools handle
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 20:38:39,541 | mcp.server.lowlevel.server | INFO | Processing request of type CallToolRequest
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 20:38:39,543 | leave-server | INFO | \U0001f50c MCP TOOL: analyze_leave_request
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 20:38:39,543 | leave-server | INFO |    Query: Can I take a leave?
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 20:38:39,543 | leave-server | INFO |    Employee ID: 1
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 20:38:39,544 | leave-server | ERROR | LLM extraction error: name 'asyncio' is not defined
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 20:38:39,544 | leave-server | INFO |    Extracted entities: {'start_date': None, 'end_date': None, 'leave_type': None, 'duration_days': None, 'confidence': 0.5}
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 20:38:39,544 | leave-server | INFO |    \u26a0\ufe0f Missing parameters - showing form
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 20:38:39,544 | leave-server | INFO |    Missing: start date, end date, leave type
INFO:architecture.mcp_client:[MCP-leave] 2026-01-03 20:38:39,544 | leave-server | INFO |    Result type: adaptive_card (pre-filled form)
[38;5;45müéØ ROUTING[0m
  Message: "Can I take a leave?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: leave.analyze_leave_request[0m
  Reason: MCP server: leave
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session a93ceeeb for user user-93
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:39:16] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 27 chars -> 27 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session fa5a4ae2 for user user-93
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:39:48,135 | mcp.server.lowlevel.server | INFO | Processing request of type CallToolRequest
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:39:48,135 | brochure-server | INFO | \U0001f50c MCP TOOL: generate_brochure
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:39:48,135 | brochure-server | INFO |    Topic: Coffee
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:39:48,402 | brochure-server | INFO |    Subject: Coffee
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:39:48,402 | brochure-server | INFO |    Calling LLM for content...
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:39:50,833 | brochure-server | INFO |    \u2705 Content generated: The Perfect Brew.
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:39:51,737 | httpx | INFO | HTTP Request: GET https://www.googleapis.com/customsearch/v1?q=Coffee+beans+in+a+cup&searchType=image&num=5&safe=active&imgType=photo&key=AIzaSyAejUSP2AkyUqIIldlXREFVptSZGzKZuf8&cx=20f183726d9fc4dc4 "HTTP/1.1 200 OK"
INFO:architecture.mcp_client:[MCP-brochure] 2026-01-03 20:39:51,738 | brochure-server | INFO |    \U0001f5bc\ufe0f Found valid image for 'Coffee beans in a cup': https://images.fineartamerica.com/images-medium-large-5/coffee-beans-in-coffee-c...
[38;5;45müéØ ROUTING[0m
  Message: "Create a brochure on Coffee"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: brochure.generate_brochure[0m
  Reason: MCP server: brochure
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 26d37c6b for user user-93
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:40:28] "POST /chat HTTP/1.1" 200 -
INFO:shared_utils:üìé File uploaded: budget_speech.pdf ‚Üí ..\API\state\uploads\20260103_204030_budget_speech.pdf
INFO:shared_utils:üìÑ Processing document: ..\API\state\uploads\20260103_204030_budget_speech.pdf
WARNING:shared_utils:‚ö†Ô∏è PyMuPDF not installed, falling back to PyPDF2
INFO:shared_utils:üìÑ PDF has 60 pages (using PyPDF2)
INFO:shared_utils:üìÑ PyPDF2 extracted: 93150 chars from 60 pages
INFO:shared_utils:üìÑ Extracted text length: 93137 chars
INFO:shared_utils:üìÑ Arabic characters in extracted text: 0
INFO:shared_utils:üìÑ Detected language: en, using: en
INFO:shared_utils:‚úÖ Document analysis complete: 358 chars
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:40:32] "POST /upload HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 19 chars -> 19 chars
WARNING:architecture.pre_router_guard:üõ°Ô∏è Guard blocked: category=weapons, pattern matched
WARNING:shared_utils:Blocked dangerous input (pre-router guard): category=weapons
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:40:39] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 14 chars -> 14 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session d383d38f for user user-93
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 20:41:11,262 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "What is a dog?"
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session ab813f03 for user user-93
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:41:48] "POST /chat HTTP/1.1" 200 -
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:42:00] "POST /clear_chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 26 chars -> 26 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session b617963f for user user-93
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.mcp_client:[MCP-secure_rag] 2026-01-03 20:42:33,594 - mcp.server.lowlevel.server - INFO - Processing request of type CallToolRequest
[38;5;45müéØ ROUTING[0m
  Message: "My favorite color is blue."
  Intent: nlu_fallback
  ‚Üí [38;5;39müîå MCP_SERVER: secure_rag.secure_query[0m
  Reason: MCP server: secure_rag
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session b5eeab05 for user user-93
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:43:11] "POST /chat HTTP/1.1" 200 -
INFO:llm-security:Input sanitized: 25 chars -> 25 chars
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 03eca725 for user user-93
WARNING:architecture.hybrid_router:Rasa parse error: All connection attempts failed
INFO:architecture.hybrid_router:üîç Rasa: nlu_fallback (0.00)
INFO:architecture.hybrid_router:ü§ñ Routing to LLM Router
INFO:architecture.router:Formatting response for tool: chat
[38;5;45müéØ ROUTING[0m
  Message: "What's my favorite color?"
  Intent: nlu_fallback
  ‚Üí [38;5;141müêç CODE_EXECUTION: chat[0m
  Reason: LLM generated code to call tools
INFO:architecture.conversation_memory:ConversationMemory initialized. Redis: localhost:6379/0
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:architecture.conversation_memory:Created new session 68f34c4c for user user-93
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
WARNING:architecture.conversation_memory:Redis unavailable, using in-memory fallback: Error 22 connecting to localhost:6379. The remote computer refused the network connection.
INFO:werkzeug:127.0.0.1 - - [03/Jan/2026 20:44:20] "POST /chat HTTP/1.1" 200 -
INFO:architecture.mcp_client:[MCP-knowledgebase] forrtl: error (200): program aborting due to window-CLOSE event
INFO:architecture.mcp_client:[MCP-knowledgebase] Image              PC                Routine            Line        Source
INFO:architecture.mcp_client:[MCP-knowledgebase] KERNELBASE.dll     00007FF823C5B99D  Unknown               Unknown  Unknown
INFO:architecture.mcp_client:[MCP-knowledgebase] KERNEL32.DLL       00007FF82585E8D7  Unknown               Unknown  Unknown
INFO:architecture.mcp_client:[MCP-knowledgebase] ntdll.dll          00007FF8267EC53C  Unknown               Unknown  Unknown
